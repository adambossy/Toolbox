#!/bin/bash

# Convert all HEIC files in the given directory (or current dir) to JPG
# and delete the originals after successful conversion.

DIR=${1:-.}

for file in "$DIR"/*.[Hh][Ee][Ii][Cc]; do
  [ -e "$file" ] || continue

  outfile="${file%.*}.jpg"

  echo "Converting: $file -> $outfile"
  if sips -s format jpeg "$file" --out "$outfile" >/dev/null; then
    echo "Conversion successful, deleting $file"
    rm "$file"
  else
    echo "Failed to convert $file, keeping original."
  fi
done

echo "All done."

